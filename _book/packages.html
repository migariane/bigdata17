<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Computing for Big Data (BST-262)</title>
  <meta name="description" content="Class notes for BST 262">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="Computing for Big Data (BST-262)" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Class notes for BST 262" />
  <meta name="github-repo" content="cchoirat/bigdata17" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Computing for Big Data (BST-262)" />
  
  <meta name="twitter:description" content="Class notes for BST 262" />
  

<meta name="author" content="Christine Choirat">


<meta name="date" content="2017-11-01">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="basics.html">
<link rel="next" href="optimization.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Computing for Big Data</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#logistics"><i class="fa fa-check"></i><b>1.1</b> Logistics</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#prerequisites"><i class="fa fa-check"></i><b>1.2</b> Prerequisites</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#rationale"><i class="fa fa-check"></i><b>1.3</b> Rationale</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#big-data-bottlenecks"><i class="fa fa-check"></i><b>1.4</b> Big data bottlenecks</a></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#syllabus"><i class="fa fa-check"></i><b>1.5</b> Syllabus</a></li>
<li class="chapter" data-level="1.6" data-path="intro.html"><a href="intro.html#evaluation"><i class="fa fa-check"></i><b>1.6</b> Evaluation</a></li>
<li class="chapter" data-level="1.7" data-path="intro.html"><a href="intro.html#software-tools-and-packages"><i class="fa fa-check"></i><b>1.7</b> Software tools and packages</a></li>
<li class="chapter" data-level="1.8" data-path="intro.html"><a href="intro.html#datasets"><i class="fa fa-check"></i><b>1.8</b> Datasets</a><ul>
<li class="chapter" data-level="1.8.1" data-path="intro.html"><a href="intro.html#movielens"><i class="fa fa-check"></i><b>1.8.1</b> MovieLens</a></li>
<li class="chapter" data-level="1.8.2" data-path="intro.html"><a href="intro.html#airlines-data"><i class="fa fa-check"></i><b>1.8.2</b> Airlines data</a></li>
<li class="chapter" data-level="1.8.3" data-path="intro.html"><a href="intro.html#insurance-claims"><i class="fa fa-check"></i><b>1.8.3</b> Insurance claims</a></li>
<li class="chapter" data-level="1.8.4" data-path="intro.html"><a href="intro.html#census"><i class="fa fa-check"></i><b>1.8.4</b> Census</a></li>
<li class="chapter" data-level="1.8.5" data-path="intro.html"><a href="intro.html#pm2.5-exposure"><i class="fa fa-check"></i><b>1.8.5</b> PM<sub>2.5</sub> exposure</a></li>
<li class="chapter" data-level="1.8.6" data-path="intro.html"><a href="intro.html#methylation"><i class="fa fa-check"></i><b>1.8.6</b> Methylation</a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="intro.html"><a href="intro.html#contributing-with-github"><i class="fa fa-check"></i><b>1.9</b> Contributing with GitHub</a></li>
<li class="chapter" data-level="1.10" data-path="intro.html"><a href="intro.html#before-we-start"><i class="fa fa-check"></i><b>1.10</b> Before we start…</a></li>
<li class="chapter" data-level="1.11" data-path="intro.html"><a href="intro.html#style"><i class="fa fa-check"></i><b>1.11</b> Style</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="basics.html"><a href="basics.html"><i class="fa fa-check"></i><b>2</b> Basic tools</a><ul>
<li class="chapter" data-level="2.1" data-path="basics.html"><a href="basics.html#command-line-tools"><i class="fa fa-check"></i><b>2.1</b> Command line tools</a><ul>
<li class="chapter" data-level="2.1.1" data-path="basics.html"><a href="basics.html#why-use-the-command-line"><i class="fa fa-check"></i><b>2.1.1</b> Why use the command line?</a></li>
<li class="chapter" data-level="2.1.2" data-path="basics.html"><a href="basics.html#basic-unix-tools"><i class="fa fa-check"></i><b>2.1.2</b> Basic Unix tools</a></li>
<li class="chapter" data-level="2.1.3" data-path="basics.html"><a href="basics.html#useful-tools"><i class="fa fa-check"></i><b>2.1.3</b> Useful tools</a></li>
<li class="chapter" data-level="2.1.4" data-path="basics.html"><a href="basics.html#example"><i class="fa fa-check"></i><b>2.1.4</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="basics.html"><a href="basics.html#makefiles"><i class="fa fa-check"></i><b>2.2</b> Makefiles</a><ul>
<li class="chapter" data-level="2.2.1" data-path="basics.html"><a href="basics.html#simulate-data-in-r"><i class="fa fa-check"></i><b>2.2.1</b> Simulate data in R</a></li>
<li class="chapter" data-level="2.2.2" data-path="basics.html"><a href="basics.html#create-a-plot-in-python"><i class="fa fa-check"></i><b>2.2.2</b> Create a plot in Python</a></li>
<li class="chapter" data-level="2.2.3" data-path="basics.html"><a href="basics.html#run-statistical-model-in-r"><i class="fa fa-check"></i><b>2.2.3</b> Run statistical model in R</a></li>
<li class="chapter" data-level="2.2.4" data-path="basics.html"><a href="basics.html#run-statistical-model-in-r-1"><i class="fa fa-check"></i><b>2.2.4</b> Run statistical model in R</a></li>
<li class="chapter" data-level="2.2.5" data-path="basics.html"><a href="basics.html#makefile-syntax"><i class="fa fa-check"></i><b>2.2.5</b> Makefile syntax</a></li>
<li class="chapter" data-level="2.2.6" data-path="basics.html"><a href="basics.html#naive-version"><i class="fa fa-check"></i><b>2.2.6</b> Naive version</a></li>
<li class="chapter" data-level="2.2.7" data-path="basics.html"><a href="basics.html#making-all-targets"><i class="fa fa-check"></i><b>2.2.7</b> Making all targets</a></li>
<li class="chapter" data-level="2.2.8" data-path="basics.html"><a href="basics.html#dealing-with-dependencies"><i class="fa fa-check"></i><b>2.2.8</b> Dealing with dependencies</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="basics.html"><a href="basics.html#git-and-github"><i class="fa fa-check"></i><b>2.3</b> Git and GitHub</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="packages.html"><a href="packages.html"><i class="fa fa-check"></i><b>3</b> Packages</a><ul>
<li class="chapter" data-level="3.1" data-path="packages.html"><a href="packages.html#why"><i class="fa fa-check"></i><b>3.1</b> Why?</a></li>
<li class="chapter" data-level="3.2" data-path="packages.html"><a href="packages.html#package-structure"><i class="fa fa-check"></i><b>3.2</b> Package structure</a></li>
<li class="chapter" data-level="3.3" data-path="packages.html"><a href="packages.html#building-steps"><i class="fa fa-check"></i><b>3.3</b> Building steps</a><ul>
<li class="chapter" data-level="3.3.1" data-path="packages.html"><a href="packages.html#r-cmd-build"><i class="fa fa-check"></i><b>3.3.1</b> <code>R CMD build</code></a></li>
<li class="chapter" data-level="3.3.2" data-path="packages.html"><a href="packages.html#r-cmd-install"><i class="fa fa-check"></i><b>3.3.2</b> <code>R CMD INSTALL</code></a></li>
<li class="chapter" data-level="3.3.3" data-path="packages.html"><a href="packages.html#r-cmd-check"><i class="fa fa-check"></i><b>3.3.3</b> <code>R CMD check</code></a></li>
<li class="chapter" data-level="3.3.4" data-path="packages.html"><a href="packages.html#building-steps-with-devtools"><i class="fa fa-check"></i><b>3.3.4</b> Building steps with <code>devtools</code></a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="packages.html"><a href="packages.html#create-an-r-package"><i class="fa fa-check"></i><b>3.4</b> Create an R package</a><ul>
<li class="chapter" data-level="3.4.1" data-path="packages.html"><a href="packages.html#utilspackage.skeleton"><i class="fa fa-check"></i><b>3.4.1</b> <code>utils::package.skeleton</code></a></li>
<li class="chapter" data-level="3.4.2" data-path="packages.html"><a href="packages.html#devtoolscreate"><i class="fa fa-check"></i><b>3.4.2</b> <code>devtools::create</code></a></li>
<li class="chapter" data-level="3.4.3" data-path="packages.html"><a href="packages.html#submit-to-cran"><i class="fa fa-check"></i><b>3.4.3</b> Submit to CRAN</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="packages.html"><a href="packages.html#r-packages-on-github"><i class="fa fa-check"></i><b>3.5</b> R packages on GitHub</a><ul>
<li class="chapter" data-level="3.5.1" data-path="packages.html"><a href="packages.html#gitignore"><i class="fa fa-check"></i><b>3.5.1</b> <code>.gitignore</code></a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="packages.html"><a href="packages.html#rstudio-projects"><i class="fa fa-check"></i><b>3.6</b> RStudio projects</a><ul>
<li class="chapter" data-level="3.6.1" data-path="packages.html"><a href="packages.html#project-options"><i class="fa fa-check"></i><b>3.6.1</b> Project options</a></li>
<li class="chapter" data-level="3.6.2" data-path="packages.html"><a href="packages.html#package-documentation"><i class="fa fa-check"></i><b>3.6.2</b> Package documentation</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="packages.html"><a href="packages.html#package-workflow-example"><i class="fa fa-check"></i><b>3.7</b> Package workflow example</a><ul>
<li class="chapter" data-level="3.7.1" data-path="packages.html"><a href="packages.html#add-linreg.r-to-r-directory"><i class="fa fa-check"></i><b>3.7.1</b> Add <code>linreg.R</code> to <code>R/</code> directory</a></li>
<li class="chapter" data-level="3.7.2" data-path="packages.html"><a href="packages.html#run-our-function"><i class="fa fa-check"></i><b>3.7.2</b> Run our function</a></li>
<li class="chapter" data-level="3.7.3" data-path="packages.html"><a href="packages.html#add-roxygen2-documentation"><i class="fa fa-check"></i><b>3.7.3</b> Add ROxygen2 documentation</a></li>
<li class="chapter" data-level="3.7.4" data-path="packages.html"><a href="packages.html#configure-build-tools"><i class="fa fa-check"></i><b>3.7.4</b> Configure Build Tools</a></li>
<li class="chapter" data-level="3.7.5" data-path="packages.html"><a href="packages.html#man-page"><i class="fa fa-check"></i><b>3.7.5</b> <code>man</code> page</a></li>
<li class="chapter" data-level="3.7.6" data-path="packages.html"><a href="packages.html#formatted-output"><i class="fa fa-check"></i><b>3.7.6</b> Formatted output</a></li>
<li class="chapter" data-level="3.7.7" data-path="packages.html"><a href="packages.html#description"><i class="fa fa-check"></i><b>3.7.7</b> <code>DESCRIPTION</code></a></li>
<li class="chapter" data-level="3.7.8" data-path="packages.html"><a href="packages.html#namespace"><i class="fa fa-check"></i><b>3.7.8</b> <code>NAMESPACE</code></a></li>
<li class="chapter" data-level="3.7.9" data-path="packages.html"><a href="packages.html#s3-basics"><i class="fa fa-check"></i><b>3.7.9</b> S3 basics</a></li>
<li class="chapter" data-level="3.7.10" data-path="packages.html"><a href="packages.html#s3-and-s4-generics"><i class="fa fa-check"></i><b>3.7.10</b> S3 and S4 generics</a></li>
<li class="chapter" data-level="3.7.11" data-path="packages.html"><a href="packages.html#print"><i class="fa fa-check"></i><b>3.7.11</b> <code>print</code></a></li>
<li class="chapter" data-level="3.7.12" data-path="packages.html"><a href="packages.html#other-methods"><i class="fa fa-check"></i><b>3.7.12</b> Other methods</a></li>
<li class="chapter" data-level="3.7.13" data-path="packages.html"><a href="packages.html#formulas-and-model-frames"><i class="fa fa-check"></i><b>3.7.13</b> Formulas and model frames</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="packages.html"><a href="packages.html#unit-testing"><i class="fa fa-check"></i><b>3.8</b> Unit testing</a><ul>
<li class="chapter" data-level="3.8.1" data-path="packages.html"><a href="packages.html#unit-tests-and-testthat"><i class="fa fa-check"></i><b>3.8.1</b> Unit tests and <code>testthat</code></a></li>
<li class="chapter" data-level="3.8.2" data-path="packages.html"><a href="packages.html#test_coef.r"><i class="fa fa-check"></i><b>3.8.2</b> <code>test_coef.R</code></a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="packages.html"><a href="packages.html#continuous-integration"><i class="fa fa-check"></i><b>3.9</b> Continuous integration</a></li>
<li class="chapter" data-level="3.10" data-path="packages.html"><a href="packages.html#code-coverage"><i class="fa fa-check"></i><b>3.10</b> Code coverage</a></li>
<li class="chapter" data-level="3.11" data-path="packages.html"><a href="packages.html#back-to-github"><i class="fa fa-check"></i><b>3.11</b> Back to GitHub</a></li>
<li class="chapter" data-level="3.12" data-path="packages.html"><a href="packages.html#vignettes"><i class="fa fa-check"></i><b>3.12</b> Vignettes</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="optimization.html"><a href="optimization.html"><i class="fa fa-check"></i><b>4</b> Optimization</a><ul>
<li class="chapter" data-level="4.1" data-path="optimization.html"><a href="optimization.html#measuring-performance"><i class="fa fa-check"></i><b>4.1</b> Measuring performance</a><ul>
<li class="chapter" data-level="4.1.1" data-path="optimization.html"><a href="optimization.html#benchmarking"><i class="fa fa-check"></i><b>4.1.1</b> Benchmarking</a></li>
<li class="chapter" data-level="4.1.2" data-path="optimization.html"><a href="optimization.html#profiling-and-optimization"><i class="fa fa-check"></i><b>4.1.2</b> Profiling and optimization</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="optimization.html"><a href="optimization.html#improving-performance"><i class="fa fa-check"></i><b>4.2</b> Improving performance</a></li>
<li class="chapter" data-level="4.3" data-path="optimization.html"><a href="optimization.html#vectorization"><i class="fa fa-check"></i><b>4.3</b> Vectorization</a></li>
<li class="chapter" data-level="4.4" data-path="optimization.html"><a href="optimization.html#parallelization"><i class="fa fa-check"></i><b>4.4</b> Parallelization</a></li>
<li class="chapter" data-level="4.5" data-path="optimization.html"><a href="optimization.html#introduction-to-c"><i class="fa fa-check"></i><b>4.5</b> Introduction to C++</a><ul>
<li class="chapter" data-level="4.5.1" data-path="optimization.html"><a href="optimization.html#rcpp"><i class="fa fa-check"></i><b>4.5.1</b> Rcpp</a></li>
<li class="chapter" data-level="4.5.2" data-path="optimization.html"><a href="optimization.html#hello-world"><i class="fa fa-check"></i><b>4.5.2</b> Hello World!</a></li>
<li class="chapter" data-level="4.5.3" data-path="optimization.html"><a href="optimization.html#sourcecpp"><i class="fa fa-check"></i><b>4.5.3</b> <code>sourceCpp</code></a></li>
<li class="chapter" data-level="4.5.4" data-path="optimization.html"><a href="optimization.html#data-types"><i class="fa fa-check"></i><b>4.5.4</b> Data types</a></li>
<li class="chapter" data-level="4.5.5" data-path="optimization.html"><a href="optimization.html#sugar"><i class="fa fa-check"></i><b>4.5.5</b> Sugar</a></li>
<li class="chapter" data-level="4.5.6" data-path="optimization.html"><a href="optimization.html#example-continued"><i class="fa fa-check"></i><b>4.5.6</b> Example (continued)</a></li>
<li class="chapter" data-level="4.5.7" data-path="optimization.html"><a href="optimization.html#back-to-linreg"><i class="fa fa-check"></i><b>4.5.7</b> Back to Linreg</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="optimization.html"><a href="optimization.html#rcpp-packages"><i class="fa fa-check"></i><b>4.6</b> Rcpp packages</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="databases.html"><a href="databases.html"><i class="fa fa-check"></i><b>5</b> Databases</a><ul>
<li class="chapter" data-level="5.1" data-path="databases.html"><a href="databases.html#overview"><i class="fa fa-check"></i><b>5.1</b> Overview</a></li>
<li class="chapter" data-level="5.2" data-path="databases.html"><a href="databases.html#sql"><i class="fa fa-check"></i><b>5.2</b> SQL</a></li>
<li class="chapter" data-level="5.3" data-path="databases.html"><a href="databases.html#nosql"><i class="fa fa-check"></i><b>5.3</b> noSQL</a></li>
<li class="chapter" data-level="5.4" data-path="databases.html"><a href="databases.html#r-interfaces"><i class="fa fa-check"></i><b>5.4</b> R interfaces</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="bigdata.html"><a href="bigdata.html"><i class="fa fa-check"></i><b>6</b> Big data</a><ul>
<li class="chapter" data-level="6.1" data-path="bigdata.html"><a href="bigdata.html#list-of-tools"><i class="fa fa-check"></i><b>6.1</b> List of tools</a></li>
<li class="chapter" data-level="6.2" data-path="bigdata.html"><a href="bigdata.html#data-that-fits-in-memory"><i class="fa fa-check"></i><b>6.2</b> Data that fits in memory</a><ul>
<li class="chapter" data-level="6.2.1" data-path="bigdata.html"><a href="bigdata.html#faster-io"><i class="fa fa-check"></i><b>6.2.1</b> Faster I/O</a></li>
<li class="chapter" data-level="6.2.2" data-path="bigdata.html"><a href="bigdata.html#reference-vs-copy"><i class="fa fa-check"></i><b>6.2.2</b> Reference vs copy</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="bigdata.html"><a href="bigdata.html#data-that-doesnt-fit-in-memory-but-fits-on-drive"><i class="fa fa-check"></i><b>6.3</b> Data that doesn’t fit in memory (but fits on drive)</a></li>
<li class="chapter" data-level="6.4" data-path="bigdata.html"><a href="bigdata.html#pure-r-solutions"><i class="fa fa-check"></i><b>6.4</b> Pure R solutions</a><ul>
<li class="chapter" data-level="6.4.1" data-path="bigdata.html"><a href="bigdata.html#sampling"><i class="fa fa-check"></i><b>6.4.1</b> Sampling</a></li>
<li class="chapter" data-level="6.4.2" data-path="bigdata.html"><a href="bigdata.html#bigmemory"><i class="fa fa-check"></i><b>6.4.2</b> <code>bigmemory</code></a></li>
<li class="chapter" data-level="6.4.3" data-path="bigdata.html"><a href="bigdata.html#database-connections-and-lazy-evaluation"><i class="fa fa-check"></i><b>6.4.3</b> Database connections and lazy evaluation</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="bigdata.html"><a href="bigdata.html#scaling-up"><i class="fa fa-check"></i><b>6.5</b> Scaling up</a><ul>
<li class="chapter" data-level="6.5.1" data-path="bigdata.html"><a href="bigdata.html#parallel-computing-and-clusters"><i class="fa fa-check"></i><b>6.5.1</b> Parallel computing and clusters</a></li>
<li class="chapter" data-level="6.5.2" data-path="bigdata.html"><a href="bigdata.html#cloud-computing"><i class="fa fa-check"></i><b>6.5.2</b> Cloud computing</a></li>
<li class="chapter" data-level="6.5.3" data-path="bigdata.html"><a href="bigdata.html#spark"><i class="fa fa-check"></i><b>6.5.3</b> Spark</a></li>
<li class="chapter" data-level="6.5.4" data-path="bigdata.html"><a href="bigdata.html#h2o-and-sparkling-water"><i class="fa fa-check"></i><b>6.5.4</b> <code>h2o</code> and <code>Sparkling Water</code></a></li>
<li class="chapter" data-level="6.5.5" data-path="bigdata.html"><a href="bigdata.html#more"><i class="fa fa-check"></i><b>6.5.5</b> More?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i><b>7</b> Visualization</a><ul>
<li class="chapter" data-level="7.1" data-path="visualization.html"><a href="visualization.html#principles-of-visualization"><i class="fa fa-check"></i><b>7.1</b> Principles of visualization</a></li>
<li class="chapter" data-level="7.2" data-path="visualization.html"><a href="visualization.html#maps-and-gis"><i class="fa fa-check"></i><b>7.2</b> Maps and GIS</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Computing for Big Data (BST-262)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="packages" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Packages</h1>
<p>We strongly recommand <span class="citation">Wickham (<a href="#ref-Wickham2015">2015</a>)</span>.</p>
<p>We assume the following packages are installed:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="kw">c</span>(<span class="st">&quot;devtools&quot;</span>, <span class="st">&quot;roxygen2&quot;</span>, <span class="st">&quot;testthat&quot;</span>, <span class="st">&quot;knitr&quot;</span>))</code></pre></div>
<div id="why" class="section level2">
<h2><span class="header-section-number">3.1</span> Why?</h2>
<ul>
<li><p>Organize your code</p></li>
<li><p>Distribute your code</p></li>
<li><p>Keep versions of your code</p></li>
</ul>
</div>
<div id="package-structure" class="section level2">
<h2><span class="header-section-number">3.2</span> Package structure</h2>
<ul>
<li>Folder hierarchy
<ul>
<li><code>NAMESPACE</code>: package import / export</li>
<li><code>DESCRIPTION</code>: metadata</li>
<li><code>R/</code>: R code</li>
<li><code>man/</code>: object documentation (with short examples)</li>
<li><code>tests/</code></li>
<li><code>data/</code></li>
<li><code>src/</code>: compiled code</li>
<li><code>vignettes/</code>: manual-like documentation</li>
<li><code>inst/</code>: installed files</li>
<li><code>demo/</code>: longer examples</li>
<li><code>exec</code>, <code>po</code>, <code>tools</code></li>
</ul></li>
</ul>
</div>
<div id="building-steps" class="section level2">
<h2><span class="header-section-number">3.3</span> Building steps</h2>
<ul>
<li><p><code>R CMD build</code></p></li>
<li><p><code>R CMD INSTALL</code></p></li>
<li><p><code>R CMD check</code></p></li>
</ul>
<div id="r-cmd-build" class="section level3">
<h3><span class="header-section-number">3.3.1</span> <code>R CMD build</code></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">R CMD build <span class="op">--</span>help</code></pre></div>
<p><em>Build R packages from package sources in the directories specified by ‘pkgdirs’</em></p>
</div>
<div id="r-cmd-install" class="section level3">
<h3><span class="header-section-number">3.3.2</span> <code>R CMD INSTALL</code></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">R CMD INSTALL <span class="op">--</span>help</code></pre></div>
<p><em>Install the add-on packages specified by pkgs. The elements of pkgs can be relative or absolute paths to directories with the package sources, or to gzipped package ‘tar’ archives. The library tree to install to can be specified via ‘–library’. By default, packages are installed in the library tree rooted at the first directory in .libPaths() for an R session run in the current environment.</em></p>
</div>
<div id="r-cmd-check" class="section level3">
<h3><span class="header-section-number">3.3.3</span> <code>R CMD check</code></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">R CMD check <span class="op">--</span>help</code></pre></div>
<p><a href="http://r-pkgs.had.co.nz/check.html" class="uri">http://r-pkgs.had.co.nz/check.html</a></p>
<p><em>Check R packages from package sources, which can be directories or package ‘tar’ archives with extension ‘.tar.gz’, ‘.tar.bz2’, ‘.tar.xz’ or ‘.tgz’.</em></p>
<p><em>A variety of diagnostic checks on directory structure, index and control files are performed. The package is installed into the log directory and production of the package PDF manual is tested. All examples and tests provided by the package are tested to see if they run successfully. By default code in the vignettes is tested, as is re-building the vignette PDFs.</em></p>
</div>
<div id="building-steps-with-devtools" class="section level3">
<h3><span class="header-section-number">3.3.4</span> Building steps with <code>devtools</code></h3>
<ul>
<li><p><code>devtools::build</code></p></li>
<li><p><code>devtools::install</code></p></li>
<li><p><code>devtools::check</code></p></li>
<li><p>and many others: <code>load_all</code>, <code>document</code>, <code>test</code>, <code>run_examples</code>, …</p></li>
</ul>
</div>
</div>
<div id="create-an-r-package" class="section level2">
<h2><span class="header-section-number">3.4</span> Create an R package</h2>
<div id="utilspackage.skeleton" class="section level3">
<h3><span class="header-section-number">3.4.1</span> <code>utils::package.skeleton</code></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">package.skeleton</span>() <span class="co"># &quot;in &quot;clean&quot; session (&quot;anRpackage&quot;)</span>
<span class="kw">package.skeleton</span>(<span class="st">&quot;pkgname&quot;</span>) <span class="co"># in &quot;clean&quot; session</span>

<span class="kw">set.seed</span>(<span class="dv">02138</span>)
f &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) x<span class="op">+</span>y
g &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) x<span class="op">-</span>y
d &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">a =</span> <span class="dv">1</span>, <span class="dt">b =</span> <span class="dv">2</span>)
e &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1000</span>)
<span class="kw">package.skeleton</span>(<span class="dt">list =</span> <span class="kw">c</span>(<span class="st">&quot;f&quot;</span>,<span class="st">&quot;g&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;e&quot;</span>), <span class="dt">name =</span> <span class="st">&quot;pkgname&quot;</span>)</code></pre></div>
</div>
<div id="devtoolscreate" class="section level3">
<h3><span class="header-section-number">3.4.2</span> <code>devtools::create</code></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools<span class="op">::</span><span class="kw">create</span>(<span class="st">&quot;path/to/package/pkgname&quot;</span>)</code></pre></div>
<p>Also from RStudio (`File -&gt; New Project’).</p>
</div>
<div id="submit-to-cran" class="section level3">
<h3><span class="header-section-number">3.4.3</span> Submit to CRAN</h3>
<div class="figure" style="text-align: center"><span id="fig:hydra"></span>
<img src="images/ch3_hydra.jpg" alt="Submitting to CRAN.  It's not that bad..."  />
<p class="caption">
Figure 3.1: Submitting to CRAN. It’s not that bad…
</p>
</div>
<p>Reading: <a href="http://r-pkgs.had.co.nz/release.html" class="uri">http://r-pkgs.had.co.nz/release.html</a></p>
</div>
</div>
<div id="r-packages-on-github" class="section level2">
<h2><span class="header-section-number">3.5</span> R packages on GitHub</h2>
<p>Reading: <a href="http://r-pkgs.had.co.nz/git.html" class="uri">http://r-pkgs.had.co.nz/git.html</a></p>
<ul>
<li><p>Version control</p></li>
<li><p>Website, wiki, project management</p></li>
<li><p>Easy install: <code>install_github</code> from <code>devtools</code></p></li>
<li><p>Collaboration</p></li>
<li><p>Issue tracking</p></li>
</ul>
<div id="rstudio-and-github-integration" class="section level4">
<h4><span class="header-section-number">3.5.0.1</span> RStudio and GitHub integration</h4>
<div class="figure" style="text-align: center"><span id="fig:pkg1"></span>
<img src="images/ch3_pkg_1_github.png" alt="Create a new Linreg repository on GitHub"  />
<p class="caption">
Figure 3.2: Create a new Linreg repository on GitHub
</p>
</div>
<div class="figure" style="text-align: center"><span id="fig:pkg2"></span>
<img src="images/ch3_pkg_2_project.png" alt="Create a new project in RStudio"  />
<p class="caption">
Figure 3.3: Create a new project in RStudio
</p>
</div>
<div class="figure" style="text-align: center"><span id="fig:pkg3"></span>
<img src="images/ch3_pkg_3_package.png" alt="Select R package"  />
<p class="caption">
Figure 3.4: Select R package
</p>
</div>
<div class="figure" style="text-align: center"><span id="fig:pkg4"></span>
<img src="images/ch3_pkg_4_create.png" alt="Create the Linreg R package as a Git repository"  />
<p class="caption">
Figure 3.5: Create the Linreg R package as a Git repository
</p>
</div>
<div class="figure" style="text-align: center"><span id="fig:pkg5"></span>
<img src="images/ch3_pkg_5_filelist.png" alt="Automatically created files"  />
<p class="caption">
Figure 3.6: Automatically created files
</p>
</div>
<div class="figure" style="text-align: center"><span id="fig:pkg6"></span>
<img src="images/ch3_pkg_6_install.png" alt="Build tab in RStudio"  />
<p class="caption">
Figure 3.7: Build tab in RStudio
</p>
</div>
<div class="figure" style="text-align: center"><span id="fig:pkg7"></span>
<img src="images/ch3_pkg_7_github.png" alt="Github webpage"  />
<p class="caption">
Figure 3.8: Github webpage
</p>
</div>
<div class="figure" style="text-align: center"><span id="fig:term"></span>
<img src="images/ch3_pkg_8_terminal.png" alt="Open a terminal"  />
<p class="caption">
Figure 3.9: Open a terminal
</p>
</div>
<p><strong>Command line</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># git init # already run when creating package with RStudio</span>
git add <span class="op">*</span>
git commit <span class="op">-</span>m <span class="st">&quot;First commit&quot;</span>
git remote add origin https<span class="op">:</span><span class="er">//</span>github.com<span class="op">/</span>cchoirat<span class="op">/</span>Linreg
git push <span class="op">-</span>u origin master</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:pkg9"></span>
<img src="images/ch3_pkg_9_github.png" alt="Github webpage is updated"  />
<p class="caption">
Figure 3.10: Github webpage is updated
</p>
</div>
</div>
<div id="gitignore" class="section level3">
<h3><span class="header-section-number">3.5.1</span> <code>.gitignore</code></h3>
<p>RStudio default</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">.Rproj.user
.Rhistory
.RData</code></pre></div>
<p>GitHub default</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># History files</span>
.Rhistory
.Rapp.history

<span class="co"># Example code in package build process</span>
<span class="op">*-</span>Ex.R

<span class="co"># RStudio files</span>
.Rproj.user<span class="op">/</span>

<span class="co"># produced vignettes</span>
vignettes<span class="op">/</span><span class="er">*</span>.html
vignettes<span class="op">/</span><span class="er">*</span>.pdf</code></pre></div>
</div>
</div>
<div id="rstudio-projects" class="section level2">
<h2><span class="header-section-number">3.6</span> RStudio projects</h2>
<ul>
<li><p><code>.Rproj</code> file extension, in our example <code>Linreg.Rproj</code></p></li>
<li>A project has its own:
<ul>
<li>R session</li>
<li>.Rprofile (<em>e.g.</em>, to customize startup environment)</li>
<li>.Rhistory</li>
</ul></li>
<li><p>Default working directory is project directory</p></li>
<li><p>Keeps track of project-specific recent files</p></li>
</ul>
<div id="project-options" class="section level3">
<h3><span class="header-section-number">3.6.1</span> Project options</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Version<span class="op">:</span><span class="st"> </span><span class="fl">1.0</span>

RestoreWorkspace<span class="op">:</span><span class="st"> </span>Default
SaveWorkspace<span class="op">:</span><span class="st"> </span>Default
AlwaysSaveHistory<span class="op">:</span><span class="st"> </span>Default

EnableCodeIndexing<span class="op">:</span><span class="st"> </span>Yes
UseSpacesForTab<span class="op">:</span><span class="st"> </span>Yes
NumSpacesForTab<span class="op">:</span><span class="st"> </span><span class="dv">2</span>
Encoding<span class="op">:</span><span class="st"> </span>UTF<span class="op">-</span><span class="dv">8</span>

RnwWeave<span class="op">:</span><span class="st"> </span>knitr
LaTeX<span class="op">:</span><span class="st"> </span>pdfLaTeX

AutoAppendNewline<span class="op">:</span><span class="st"> </span>Yes
StripTrailingWhitespace<span class="op">:</span><span class="st"> </span>Yes

BuildType<span class="op">:</span><span class="st"> </span>Package
PackageUseDevtools<span class="op">:</span><span class="st"> </span>Yes
PackageInstallArgs<span class="op">:</span><span class="st"> </span><span class="op">--</span>no<span class="op">-</span>multiarch <span class="op">--</span>with<span class="op">-</span>keep.source</code></pre></div>
</div>
<div id="package-documentation" class="section level3">
<h3><span class="header-section-number">3.6.2</span> Package documentation</h3>
<ul>
<li><p>Functions and methods</p></li>
<li>Vignettes
<ul>
<li>PDF</li>
<li><code>knitr</code></li>
</ul></li>
</ul>
</div>
</div>
<div id="package-workflow-example" class="section level2">
<h2><span class="header-section-number">3.7</span> Package workflow example</h2>
<p>Creating R Packages: A Tutorial (Friedrich Leisch, 2009)</p>
<p>Our example is adapted from <a href="https://cran.r-project.org/doc/contrib/Leisch-CreatingPackages.pdf" class="uri">https://cran.r-project.org/doc/contrib/Leisch-CreatingPackages.pdf</a>.</p>
<div id="add-linreg.r-to-r-directory" class="section level3">
<h3><span class="header-section-number">3.7.1</span> Add <code>linreg.R</code> to <code>R/</code> directory</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">linmodEst &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {
  ## CC: crossprod or a QR decomposition (as in the original version) are more efficient
  coef &lt;-<span class="st"> </span><span class="kw">solve</span>(<span class="kw">t</span>(x) <span class="op">%*%</span><span class="st"> </span>x) <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(x) <span class="op">%*%</span><span class="st"> </span>y
  <span class="kw">print</span>(coef)
  ## degrees of freedom and standard deviation of residuals
  df &lt;-<span class="st"> </span><span class="kw">nrow</span>(x) <span class="op">-</span><span class="st"> </span><span class="kw">ncol</span>(x)
  sigma2 &lt;-<span class="st"> </span><span class="kw">sum</span>((y <span class="op">-</span><span class="st"> </span>x <span class="op">%*%</span><span class="st"> </span>coef) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span>df
  ## compute sigma^2 * (x’x)^-1
  vcov &lt;-<span class="st"> </span>sigma2 <span class="op">*</span><span class="st"> </span><span class="kw">solve</span>(<span class="kw">t</span>(x) <span class="op">%*%</span><span class="st"> </span>x)
  <span class="kw">colnames</span>(vcov) &lt;-<span class="st"> </span><span class="kw">rownames</span>(vcov) &lt;-<span class="st"> </span><span class="kw">colnames</span>(x)
  <span class="kw">list</span>(
    <span class="dt">coefficients =</span> coef,
    <span class="dt">vcov =</span> vcov,
    <span class="dt">sigma =</span> <span class="kw">sqrt</span>(sigma2),
    <span class="dt">df =</span> df
  )
}</code></pre></div>
</div>
<div id="run-our-function" class="section level3">
<h3><span class="header-section-number">3.7.2</span> Run our function</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(cats, <span class="dt">package =</span> <span class="st">&quot;MASS&quot;</span>)
<span class="kw">linmodEst</span>(<span class="kw">cbind</span>(<span class="dv">1</span>, cats<span class="op">$</span>Bwt), cats<span class="op">$</span>Hwt)</code></pre></div>
<pre><code>##            [,1]
## [1,] -0.3566624
## [2,]  4.0340627</code></pre>
<pre><code>## $coefficients
##            [,1]
## [1,] -0.3566624
## [2,]  4.0340627
## 
## $vcov
##            [,1]        [,2]
## [1,]  0.4792475 -0.17058197
## [2,] -0.1705820  0.06263081
## 
## $sigma
## [1] 1.452373
## 
## $df
## [1] 142</code></pre>
<p>We can compare the output with <code>lm</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lm1 &lt;-<span class="st"> </span><span class="kw">lm</span>(Hwt <span class="op">~</span><span class="st"> </span>Bwt, <span class="dt">data =</span> cats)
lm1</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Hwt ~ Bwt, data = cats)
## 
## Coefficients:
## (Intercept)          Bwt  
##     -0.3567       4.0341</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">coef</span>(lm1)</code></pre></div>
<pre><code>## (Intercept)         Bwt 
##  -0.3566624   4.0340627</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">vcov</span>(lm1)</code></pre></div>
<pre><code>##             (Intercept)         Bwt
## (Intercept)   0.4792475 -0.17058197
## Bwt          -0.1705820  0.06263081</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(lm1)<span class="op">$</span>sigma</code></pre></div>
<pre><code>## [1] 1.452373</code></pre>
</div>
<div id="add-roxygen2-documentation" class="section level3">
<h3><span class="header-section-number">3.7.3</span> Add ROxygen2 documentation</h3>
<p>Reading: <a href="http://kbroman.org/pkg_primer/pages/docs.html" class="uri">http://kbroman.org/pkg_primer/pages/docs.html</a></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#&#39; Linear regression</span>
<span class="co">#&#39;</span>
<span class="co">#&#39; Runs an OLS regression not unlike \code{\link{lm}}</span>
<span class="co">#&#39;</span>
<span class="co">#&#39; @param y response vector (1 x n)</span>
<span class="co">#&#39; @param X covariate matrix (p x n) with no intercept</span>
<span class="co">#&#39;</span>
<span class="co">#&#39; @return A list with 4 elements: coefficients, vcov, sigma, df</span>
<span class="co">#&#39;</span>
<span class="co">#&#39; @examples</span>
<span class="co">#&#39; data(mtcars)</span>
<span class="co">#&#39; X &lt;- as.matrix(mtcars[, c(&quot;cyl&quot;, &quot;disp&quot;, &quot;hp&quot;)])</span>
<span class="co">#&#39; y &lt;- mtcars[, &quot;mpg&quot;]</span>
<span class="co">#&#39; linmodEst(y, X)</span>
<span class="co">#&#39;</span>
<span class="co">#&#39; @export</span>
<span class="co">#&#39;</span>
linmodEst &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {
  ## CC: crossprod or a QR decomposition (as in the original version) are more efficient
  coef &lt;-<span class="st"> </span><span class="kw">solve</span>(<span class="kw">t</span>(x) <span class="op">%*%</span><span class="st"> </span>x) <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(x) <span class="op">%*%</span><span class="st"> </span>y
  <span class="kw">print</span>(coef)
  ## degrees of freedom and standard deviation of residuals
  df &lt;-<span class="st"> </span><span class="kw">nrow</span>(x) <span class="op">-</span><span class="st"> </span><span class="kw">ncol</span>(x)
  sigma2 &lt;-<span class="st"> </span><span class="kw">sum</span>((y <span class="op">-</span><span class="st"> </span>x <span class="op">%*%</span><span class="st"> </span>coef) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span>df
  ## compute sigma^2 * (x’x)^-1
  vcov &lt;-<span class="st"> </span>sigma2 <span class="op">*</span><span class="st"> </span><span class="kw">solve</span>(<span class="kw">t</span>(x) <span class="op">%*%</span><span class="st"> </span>x)
  <span class="kw">colnames</span>(vcov) &lt;-<span class="st"> </span><span class="kw">rownames</span>(vcov) &lt;-<span class="st"> </span><span class="kw">colnames</span>(x)
  <span class="kw">list</span>(
    <span class="dt">coefficients =</span> coef,
    <span class="dt">vcov =</span> vcov,
    <span class="dt">sigma =</span> <span class="kw">sqrt</span>(sigma2),
    <span class="dt">df =</span> df
  )
}</code></pre></div>
</div>
<div id="configure-build-tools" class="section level3">
<h3><span class="header-section-number">3.7.4</span> Configure Build Tools</h3>
<div class="figure" style="text-align: center"><span id="fig:pkg8"></span>
<img src="images/ch3_configure_build_tools.png" alt="Roxygen options"  />
<p class="caption">
Figure 3.11: Roxygen options
</p>
</div>
</div>
<div id="man-page" class="section level3">
<h3><span class="header-section-number">3.7.5</span> <code>man</code> page</h3>
<p>File `<code>man/linmodEst.Rd</code> contains:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">% Generated by roxygen2<span class="op">:</span><span class="st"> </span>do not edit by hand
% Please edit documentation <span class="cf">in</span> R<span class="op">/</span>linreg.R
\name{linmodEst}
\alias{linmodEst}
\title{Linear regression}
\usage{
<span class="kw">linmodEst</span>(x, y)
}
\arguments{
\item{y}{response <span class="kw">vector</span> (<span class="dv">1</span> x n)}

\item{X}{covariate <span class="kw">matrix</span> (p x n) with no intercept}
}
\value{
A list with <span class="dv">4</span> elements<span class="op">:</span><span class="st"> </span>coefficients, vcov, sigma, df
}
\description{
Runs an OLS regression not unlike \code{\link{lm}}
}
\examples{
<span class="kw">data</span>(mtcars)
X &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(mtcars[, <span class="kw">c</span>(<span class="st">&quot;cyl&quot;</span>, <span class="st">&quot;disp&quot;</span>, <span class="st">&quot;hp&quot;</span>)])
y &lt;-<span class="st"> </span>mtcars[, <span class="st">&quot;mpg&quot;</span>]
<span class="kw">linmodEst</span>(y, X)

}</code></pre></div>
</div>
<div id="formatted-output" class="section level3">
<h3><span class="header-section-number">3.7.6</span> Formatted output</h3>
<p><img src="images/ch3_formatted_help.png" style="display: block; margin: auto;" /></p>
</div>
<div id="description" class="section level3">
<h3><span class="header-section-number">3.7.7</span> <code>DESCRIPTION</code></h3>
<p>Reading: <a href="http://r-pkgs.had.co.nz/description.html" class="uri">http://r-pkgs.had.co.nz/description.html</a></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Package<span class="op">:</span><span class="st"> </span>Linreg
Type<span class="op">:</span><span class="st"> </span>Package
Title<span class="op">:</span><span class="st"> </span>What the Package <span class="kw">Does</span> (Title Case)
Version<span class="op">:</span><span class="st"> </span><span class="fl">0.1</span>.<span class="dv">0</span>
Author<span class="op">:</span><span class="st"> </span>Who wrote it
Maintainer<span class="op">:</span><span class="st"> </span>The package maintainer <span class="op">&lt;</span>yourself<span class="op">@</span>somewhere.net<span class="op">&gt;</span>
Description<span class="op">:</span><span class="st"> </span>More about what it <span class="kw">does</span> (maybe more than one line)
    Use four spaces when indenting paragraphs within the Description.
License<span class="op">:</span><span class="st"> </span>What license is it under?
Encoding<span class="op">:</span><span class="st"> </span>UTF<span class="op">-</span><span class="dv">8</span>
LazyData<span class="op">:</span><span class="st"> </span>true
RoxygenNote<span class="op">:</span><span class="st"> </span><span class="fl">6.0</span>.<span class="dv">1</span></code></pre></div>
</div>
<div id="namespace" class="section level3">
<h3><span class="header-section-number">3.7.8</span> <code>NAMESPACE</code></h3>
<p>Reading: <a href="http://r-pkgs.had.co.nz/namespace.html" class="uri">http://r-pkgs.had.co.nz/namespace.html</a>, in particular <code>Imports</code> vs <code>Suggests</code></p>
<p><code>export</code>’s automatically generated when parsing ROxygen2 snippets</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">export</span>(linmodEst)</code></pre></div>
<p><img src="images/ch3_pumpkin.jpg" style="display: block; margin: auto;" /></p>
<p><img src="images/ch3_octocat-de-los-muertos.jpg" style="display: block; margin: auto;" /></p>
<ul>
<li><p>A scary hack</p></li>
<li><p>A scary tree</p></li>
</ul>
<p><img src="images/ch3_halloween_tree.jpg" style="display: block; margin: auto;" /></p>
</div>
<div id="s3-basics" class="section level3">
<h3><span class="header-section-number">3.7.9</span> S3 basics</h3>
<p>Reading: <a href="http://adv-r.had.co.nz/S3.html" class="uri">http://adv-r.had.co.nz/S3.html</a></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">hello &lt;-<span class="st"> </span><span class="cf">function</span>() {
 s &lt;-<span class="st"> &quot;Hello World!&quot;</span>
 <span class="kw">class</span>(s) &lt;-<span class="st"> &quot;hi&quot;</span>
 <span class="kw">return</span>(s)
}

<span class="kw">hello</span>()</code></pre></div>
<pre><code>## [1] &quot;Hello World!&quot;
## attr(,&quot;class&quot;)
## [1] &quot;hi&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">print.hi &lt;-<span class="st"> </span><span class="cf">function</span>(...) {
  <span class="kw">print</span>(<span class="st">&quot;Surprise!&quot;</span>)
}

<span class="kw">hello</span>()</code></pre></div>
<pre><code>## [1] &quot;Surprise!&quot;</code></pre>
</div>
<div id="s3-and-s4-generics" class="section level3">
<h3><span class="header-section-number">3.7.10</span> S3 and S4 generics</h3>
<p>Reading: <a href="http://adv-r.had.co.nz/S4.html" class="uri">http://adv-r.had.co.nz/S4.html</a></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">linmod &lt;-<span class="st"> </span><span class="cf">function</span>(x, ...)
  <span class="kw">UseMethod</span>(<span class="st">&quot;linmod&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">linmod.default &lt;-<span class="st"> </span><span class="cf">function</span>(x, y, ...) {
  x &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(x)
  y &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(y)
  est &lt;-<span class="st"> </span><span class="kw">linmodEst</span>(x, y)
  est<span class="op">$</span>fitted.values &lt;-<span class="st"> </span><span class="kw">as.vector</span>(x <span class="op">%*%</span><span class="st"> </span>est<span class="op">$</span>coefficients)
  est<span class="op">$</span>residuals &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span>est<span class="op">$</span>fitted.values
  est<span class="op">$</span>call &lt;-<span class="st"> </span><span class="kw">match.call</span>()
  <span class="kw">class</span>(est) &lt;-<span class="st"> &quot;linmod&quot;</span>
  <span class="kw">return</span>(est)
}</code></pre></div>
</div>
<div id="print" class="section level3">
<h3><span class="header-section-number">3.7.11</span> <code>print</code></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">print.linmod &lt;-<span class="st"> </span><span class="cf">function</span>(x, ...) {
  <span class="kw">cat</span>(<span class="st">&quot;Call:</span><span class="ch">\n</span><span class="st">&quot;</span>)
  <span class="kw">print</span>(x<span class="op">$</span>call)
  <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Coefficients:</span><span class="ch">\n</span><span class="st">&quot;</span>)
  <span class="kw">print</span>(x<span class="op">$</span>coefficients)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="dt">Const =</span> <span class="dv">1</span>, <span class="dt">Bwt =</span> cats<span class="op">$</span>Bwt)
y &lt;-<span class="st"> </span>cats<span class="op">$</span>Hw
mod1 &lt;-<span class="st"> </span><span class="kw">linmod</span>(x, y)</code></pre></div>
<pre><code>##             [,1]
## Const -0.3566624
## Bwt    4.0340627</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod1</code></pre></div>
<pre><code>## Call:
## linmod.default(x = x, y = y)
## 
## Coefficients:
##             [,1]
## Const -0.3566624
## Bwt    4.0340627</code></pre>
</div>
<div id="other-methods" class="section level3">
<h3><span class="header-section-number">3.7.12</span> Other methods</h3>
<ul>
<li><p><code>summary.linmod</code></p></li>
<li><p><code>print.summary.linmod</code></p></li>
<li><p><code>predict.linmod</code></p></li>
<li><p><code>plot.linmod</code></p></li>
<li><p><code>coef.linmod</code>, <code>vcov.linmod</code>, …</p></li>
</ul>

<div class="exercise">
<span id="exr:unnamed-chunk-47" class="exercise"><strong>Exercise 3.1  </strong></span>Write two functions that implement the <code>coef.linmod</code> and <code>vcov.linmod</code> methods.
</div>

</div>
<div id="formulas-and-model-frames" class="section level3">
<h3><span class="header-section-number">3.7.13</span> Formulas and model frames</h3>
<p>Reading: <a href="http://genomicsclass.github.io/book/pages/expressing_design_formula.html" class="uri">http://genomicsclass.github.io/book/pages/expressing_design_formula.html</a></p>
<blockquote>
<p><code>model.frame</code> (a generic function) and its methods return a data.frame with the variables needed to use formula and any … arguments.</p>
</blockquote>
<blockquote>
<p><code>model.matrix</code> creates a design (or model) matrix, e.g., by expanding factors to a set of dummy variables (depending on the contrasts) and expanding interactions similarly.</p>
</blockquote>
<blockquote>
<p><code>model.response</code> returns the response of a model frame passed as optional arguments to model.frame.</p>
</blockquote>

<div class="exercise">
<span id="exr:unnamed-chunk-48" class="exercise"><strong>Exercise 3.2  </strong></span>What is <code>model.extract</code>?
</div>

<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">linmod.formula &lt;-<span class="st"> </span><span class="cf">function</span>(formula, <span class="dt">data =</span> <span class="kw">list</span>(), ...) {
  mf &lt;-<span class="st"> </span><span class="kw">model.frame</span>(<span class="dt">formula =</span> formula, <span class="dt">data =</span> data)
  x &lt;-<span class="st"> </span><span class="kw">model.matrix</span>(<span class="kw">attr</span>(mf, <span class="st">&quot;terms&quot;</span>), <span class="dt">data =</span> mf)
  y &lt;-<span class="st"> </span><span class="kw">model.response</span>(mf)
  est &lt;-<span class="st"> </span><span class="kw">linmod.default</span>(x, y, ...)
  est<span class="op">$</span>call &lt;-<span class="st"> </span><span class="kw">match.call</span>()
  est<span class="op">$</span>formula &lt;-<span class="st"> </span>formula
  <span class="kw">return</span>(est)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">linmod</span>(Hwt <span class="op">~</span><span class="st"> </span><span class="op">-</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Bwt <span class="op">*</span><span class="st"> </span>Sex, <span class="dt">data =</span> cats)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Call<span class="op">:</span>
<span class="kw">linmod.formula</span>(<span class="dt">formula =</span> Hwt <span class="op">~</span><span class="st"> </span><span class="op">-</span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Bwt <span class="op">*</span><span class="st"> </span>Sex, <span class="dt">data =</span> cats)

Coefficients<span class="op">:</span>
<span class="st">      </span>Bwt      SexF      SexM  Bwt<span class="op">:</span>SexM 
 <span class="fl">2.636414</span>  <span class="fl">2.981312</span> <span class="op">-</span><span class="fl">1.184088</span>  <span class="fl">1.676265</span> </code></pre></div>
</div>
</div>
<div id="unit-testing" class="section level2">
<h2><span class="header-section-number">3.8</span> Unit testing</h2>
<div id="unit-tests-and-testthat" class="section level3">
<h3><span class="header-section-number">3.8.1</span> Unit tests and <code>testthat</code></h3>
<p>Reading: <a href="http://r-pkgs.had.co.nz/tests.html" class="uri">http://r-pkgs.had.co.nz/tests.html</a></p>
<p>In package directory:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools<span class="op">::</span><span class="kw">use_testthat</span>()</code></pre></div>
<p>pre-populates <code>test/testthat/</code></p>
<p>Test files should start with <code>test</code> to be processed.</p>
</div>
<div id="test_coef.r" class="section level3">
<h3><span class="header-section-number">3.8.2</span> <code>test_coef.R</code></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(cats, <span class="dt">package =</span> <span class="st">&quot;MASS&quot;</span>)
l1 &lt;-<span class="st"> </span><span class="kw">linmod</span>(Hwt <span class="op">~</span><span class="st"> </span>Bwt <span class="op">*</span><span class="st"> </span>Sex, <span class="dt">data =</span> cats)
l2 &lt;-<span class="st"> </span><span class="kw">lm</span>(Hwt <span class="op">~</span><span class="st"> </span>Bwt <span class="op">*</span><span class="st"> </span>Sex, <span class="dt">data =</span> cats)

<span class="kw">test_that</span>(<span class="st">&quot;same estimated coefficients as lm function&quot;</span>, {
  <span class="kw">expect_equal</span>(<span class="kw">round</span>(l1<span class="op">$</span>coefficients, <span class="dv">3</span>), <span class="kw">round</span>(l2<span class="op">$</span>coefficients, <span class="dv">3</span>))
})</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span>devtools<span class="op">::</span><span class="kw">test</span>()
Loading Linreg
Loading required package<span class="op">:</span><span class="st"> </span>testthat
Testing Linreg
.
DONE <span class="op">==</span><span class="er">=======================================================================================</span></code></pre></div>
</div>
</div>
<div id="continuous-integration" class="section level2">
<h2><span class="header-section-number">3.9</span> Continuous integration</h2>
<p>Reading: <a href="http://r-pkgs.had.co.nz/check.html#travis" class="uri">http://r-pkgs.had.co.nz/check.html#travis</a></p>
<p>Website: <a href="https://travis-ci.org/" class="uri">https://travis-ci.org/</a></p>
<p>First step is to create a Travis account and link it to you GitHub account.</p>
<p><img src="images/ch3_travis_github.png" style="display: block; margin: auto;" /></p>
<p>Travis will list all your public GitHub repositories for you to select the ones you want to test.</p>
<p><img src="images/ch3_travis_Linreg.png" style="display: block; margin: auto;" /></p>
<p>Calling</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools<span class="op">::</span><span class="kw">use_coverage</span>(<span class="dt">pkg =</span> <span class="st">&quot;.&quot;</span>, <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;codecov&quot;</span>))</code></pre></div>
<p>creates the <code>.travis.yml</code> file:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># R for travis: see documentation at https://docs.travis-ci.com/user/languages/r</span>

language<span class="op">:</span><span class="st"> </span>R
sudo<span class="op">:</span><span class="st"> </span>false
cache<span class="op">:</span><span class="st"> </span>packages</code></pre></div>
<p>and pushing <code>Linreg</code> code to GitHub will automatically triggers a Travis build… which fails!</p>
<p><img src="images/ch3_travis_failed_build.png" style="display: block; margin: auto;" /></p>
<p>To be continued…</p>
</div>
<div id="code-coverage" class="section level2">
<h2><span class="header-section-number">3.10</span> Code coverage</h2>
<p>Reading: <a href="https://walczak.org/2017/06/how-to-add-code-coverage-codecov-to-your-r-package/" class="uri">https://walczak.org/2017/06/how-to-add-code-coverage-codecov-to-your-r-package/</a></p>
<p>Website: <a href="https://codecov.io/" class="uri">https://codecov.io/</a></p>
<p>Like Travis, codecov has to be linked to a GitHub account:</p>
<p><img src="images/ch3_codecov_github.png" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools<span class="op">::</span><span class="kw">use_coverage</span>(<span class="dt">pkg =</span> <span class="st">&quot;.&quot;</span>, <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;codecov&quot;</span>))</code></pre></div>
<p>creates the <code>codecov.yml</code> file:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">comment<span class="op">:</span><span class="st"> </span>false</code></pre></div>
<p>A call to</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">covr<span class="op">::</span><span class="kw">codecov</span>(<span class="dt">token =</span> <span class="st">&quot;YOUR_TOKEN&quot;</span>)</code></pre></div>
<p>will give you code coverage information:</p>
<p><img src="images/ch3_codecov_out.png" style="display: block; margin: auto;" /></p>
</div>
<div id="back-to-github" class="section level2">
<h2><span class="header-section-number">3.11</span> Back to GitHub</h2>
<p>Badges can be added to <code>README.md</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&lt;!---</span><span class="st"> </span>Badges <span class="op">----</span>-&gt;
[<span class="op">!</span>[<span class="kw">Travis</span> (LINUX) Build Status](https<span class="op">:</span><span class="er">//</span>travis<span class="op">-</span>ci.org<span class="op">/</span>cchoirat<span class="op">/</span>Linreg.svg?<span class="dt">branch=</span>master)](https<span class="op">:</span><span class="er">//</span>travis<span class="op">-</span>ci.org<span class="op">/</span>cchoirat<span class="op">/</span>Linreg)
[<span class="op">!</span>[codecov](https<span class="op">:</span><span class="er">//</span>codecov.io<span class="op">/</span>gh<span class="op">/</span>cchoirat<span class="op">/</span>Linreg<span class="op">/</span>branch<span class="op">/</span>master<span class="op">/</span>graph<span class="op">/</span>badge.svg)](https<span class="op">:</span><span class="er">//</span>codecov.io<span class="op">/</span>gh<span class="op">/</span>cchoirat<span class="op">/</span>Linreg)

## `Linreg` package template

Based on <span class="st">&quot;Creating R Packages: A Tutorial&quot;</span> (Friedrich Leisch, <span class="dv">2009</span>)

<span class="op">-</span><span class="st"> </span>https<span class="op">:</span><span class="er">//</span>cran.r<span class="op">-</span>project.org<span class="op">/</span>doc<span class="op">/</span>contrib<span class="op">/</span>Leisch<span class="op">-</span>CreatingPackages.pdf</code></pre></div>
<p>are are automatically displayed on GitHub:</p>
<p><img src="images/ch3_badges.png" style="display: block; margin: auto;" /></p>
</div>
<div id="vignettes" class="section level2">
<h2><span class="header-section-number">3.12</span> Vignettes</h2>
<p>Reading: <a href="http://r-pkgs.had.co.nz/vignettes.html" class="uri">http://r-pkgs.had.co.nz/vignettes.html</a></p>
<p>Reading: <a href="http://kbroman.org/pkg_primer/pages/vignettes.html" class="uri">http://kbroman.org/pkg_primer/pages/vignettes.html</a></p>
<p>Even if all the functions and datasets of your package are documented, it is still useful to have a more detailed illustation on how to use your package. A <em>vignette</em> is the right place to explain a worflow and a statistical method.</p>
<p>Running:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools<span class="op">::</span><span class="kw">use_vignette</span>(<span class="st">&quot;my-linear-regression&quot;</span>)</code></pre></div>
<p>creates a <code>vignettes</code> folder and provide a template in RMarkdown format <code>my-linear-regression.Rmd</code>:</p>
<p><a href="https://github.com/cchoirat/Linreg/blob/master/vignettes/my-linear-regression.Rmd" class="uri">https://github.com/cchoirat/Linreg/blob/master/vignettes/my-linear-regression.Rmd</a></p>
<p>It also indicates in <code>DESCRIPTION</code> that vignettes should be built with <code>knitr</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">VignetteBuilder<span class="op">:</span><span class="st"> </span>knitr</code></pre></div>
<p>The vignette is built into a HTML document with</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools<span class="op">::</span><span class="kw">build_vignettes</span>()</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Building Linreg vignettes
Moving my<span class="op">-</span>linear<span class="op">-</span>regression.html, my<span class="op">-</span>linear<span class="op">-</span>regression.R to inst<span class="op">/</span>doc<span class="op">/</span>
Copying my<span class="op">-</span>linear<span class="op">-</span>regression.Rmd to inst<span class="op">/</span>doc<span class="op">/</span></code></pre></div>
<p>The vignette is accessible with</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">vignette</span>(<span class="st">&quot;my-linear-regression&quot;</span>)
<span class="kw">vignette</span>(<span class="st">&quot;my-linear-regression&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;Linreg&quot;</span>)</code></pre></div>
<p><img src="images/ch3_vignette_html.png" style="display: block; margin: auto;" /></p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-Wickham2015">
<p>Wickham, H. 2015. <em>R Packages</em>. 1st ed. O’Reilly Media, Inc.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="basics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="optimization.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/cchoirat/bigdata17edit/master/03-packages.Rmd",
"text": "Edit"
},
"download": ["Computing for Big Data.pdf", "Computing for Big Data.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
